<div align="center">
<h1>Order Service</h1>
<h3>주문 생성 및 주문상품과 배송정보 관리를 담당하는 서비스</h3>
</div>

<br>
<br>

## ERD
<img width="9116" alt="주문서비스ERD" src="https://github.com/user-attachments/assets/10170ce5-7348-49ca-9505-59754d665a6b">

<br>
<br>

## Architecture
<img width="9116" alt="주문서비스아키텍처" src="https://github.com/user-attachments/assets/48a57166-0487-423a-9d2b-74d3a6192ca3">

<img width="9116" alt="주문서비스아키텍처" src="https://github.com/user-attachments/assets/ead31395-d418-4888-9f71-7d7dba944eed">

<br>
<br>

## Description

❗주문서비스에서 배송서비스가 분리될 예정입니다.

<br>

### 주문정보/배송정보 CRUD
주문 생성, 조회 및 취소가 가능하며, 주문 생성 및 취소와 함께 배송정보도 함께 생성 및 삭제된다. 주문정보에서는 주문상품 목록을 조회할 수 있으며, 배송정보는 배송준비부터 배송완료까지 지속적으로 갱신할 수 있다.

### QueryDSL 사용
타입 안정성 및 동적쿼리 생성 등을 고려하여 QueryDSL을 활용하였다.

### Resilience4J CircuitBreaker & Retry
MSA 애플리케이션의 정상적인 사용을 위해 서비스간 통신에서는 여러 장애대응 조치를 취할 수 있다. 그러한 조치로 서킷브레이커와 리트라이 정책을 설정해주는 것이 대표적이다. 일부 서비스가 비정상이라고 하더라도 서킷브레이커가 적용된 해당 서비스에 한해서만 접근을 차단함으로써 문제가 번지는 상황을 방지하고 다른 서비스에 대해서는 정상 수행하도록 하며, 일시적 오류일 가능성에 대비해 요청을 제한적으로 재시도하도록 함으로써 안정성과 가용성을 높인다. 만약 데이터의 수정 및 저장 과정이 포함되는 로직에서는 중간에 에러가 발생할 경우 @Transactional을 통해 연쇄된 전체 트랜잭션을 롤백 및 대체 로직을 수행함으로써 서비스간 통신에서 발생하는 데이터 부정합 문제를 방지한다.

### 서비스간 통신 에러메세지 Slack 연동
서비스간 통신에서 에러가 발생할 경우 모니터링을 위해 해당 에러메세지를 연동된 Slack 채널로 전송한다.

### Kafka 비동기 처리
프로세스의 지연 및 부하는 서비스의 자원을 쉽게 고갈시키고 사용성을 저하시킬 수 있다. 이때 DB 접근에 대한 비동기 처리를 통해 기능을 보다 원활히 사용할 수 있다. 주문 및 주문상품, 배송 및 배송추적 테이블에 업데이트가 발생하면 해당 메세지 데이터를 Kafka Server로 발행한다. 발행된 메세지는 바로 Consume 되어 MongoDB로 저장함으로써 데이터 조회가 가능하도록 한다.